# 데이터베이스 구축

## SQL 분류 DDL

- DDL
  - 집 틀을 만들겠다. 정의하는것
  - create : 생성
  - alter : 추가
  - drop : 테이블 자체를 삭제
  - rename : 수정
  - truncate : 테이블 데이터를 전부 삭제하고 사용하고 있던 공간 반납
- DML
  - 그 구조에 데이터를 넣고 빼고
  - select : 검색
  - insert : 삽입
  - update : 업데이트
  - delete : 테이블 데이터 삭제
- DCL
  - 권한을 주거나 제어하는것
  - grant
    - GRANT 권한[칼럼 리스트] ON 객체 TO {사용자|역할|public}
    - [WITH GRANT OPTION]
      - (A에게 권한주고 A가 BC에게 줬을때 A꺼 뺏으면 BC도 뺏김)
  - revoke
    - REVOKE {권한리스트|ALL} ON 객체 FROM {사용자|역할|PUBLIC}
- TCL
  - 오라클에서 사용 트랜젝션
  - commit
  - rollback
  - save-point

## SQL 문

- 안에꺼 부터 읽는다
- 셀렉트 구조를 알아봐야함

  - select 속성 \*는 모든속성
  - update 는 set이 온다.
  - From table 명
  - where 조건다음 -> and | or
  - Group by : 컬럼(기준값) (count,avg,min,max)
  - having :sum () // 조건을 주고싶을때
  - order by : 속성 기준 정렬 (asc,desc)
  - like는 해당하는것 모두 (%신%) 신옆으로 아무거나 와도 된다. 언더바는 한글자
  - dept : 전부 가져와라
  - distinct : select 절에 쓴다. 중복 제거 후 가져와라이다.

## 집합 연산자

- UNION : 중복을 제거한 결과의 합을 검색
- UNION ALL : 중복을 포함한 결과의 합을 검색
- INTERSECT : 양쪽 모두에서 포함된 행을 검색
- MINUS : 첫번째 검색결과에서 두번째 검색 결과를 제외한 결과값을 검색

## 데이터베이스에서 삽입갱신삭제 등의 이벤트 발생시 자동으로 수행되는 절차형 sql은

- 트리거

## 릴레이션에 외래키

- FK키는 둘다 사용하는것

## 무결성의 종류

- 개체 무결성 : 기본키에서 널값 못가짐
- 참조 무결성 : 참조하는 값이 없으면 안됨
- 도메인 무결성 : 없는값이 들어오면 안됨
- 속성 무결성
- 키 무결성 : 키종류
- 사용자 정의 무결성
- 도메인 무결성 : 정해진 값만 들어갈 수 있다.

## 참조 무결성 유지를 위해 drop문에서 부모 테이블의 항목 값을 삭제할 경우 자동적으로 자식테이블의 해당 레코드를 삭제하는 옵션

- cascade: 자동으로 삭제이다.
- restricted: 못하게 한다.
- set-null :널을 준다.

## 뷰(view)

### 설명

- 테이블이에서 몇가지만 가져오는게 뷰다. (가상의 테이블)
- 뷰 위에 또 다른 뷰를 만들 수 있다.
- 삽입 갱신 삭제 연산에 제약이 따른다.
- 논리적으로 존재함.
- 테이블에 아이디와 네임만 가져온것 (가상의 테이블)
- create ,drop만 할 수 있음

### 장점

- 3단계 스키마
- 외부 : 구조를 보는것
  - (논리적)
- 개념 : db의 전체적 관리
  - (물리적)
- 내부 : 안의 속성이 어떤값인지
- 뷰는 논리적 독립성을 가짐
- 인덱스가 없음
- 데이터 보안 용이
- 사용자 데이터 관리 용이
- create drop 사용가능

## 인텍스의 특징

- 인덱스의 기본 목적은 검색 성능을 최적화 하는것이다.
- B-트리 인덱스는 분기를 목적으로 하는 Branch Block을 가지고 있다.
- BETWEEN등 범위 검색에 활용될 수 있다.
- 사용자가 생성하여 변경할 수 있다.

## 데이터 베이스 설계단계

- 개념설계
  - ERD 다이어그램만듬
- 논리적 설계
  - 디비구조로 매핑
  - 트랜젝션 인터페이스 설계
  - 스키마 평가 및 정제
  - 정규화
- 물리적 설계
  - 저장 레코드 양식 설계
  - 레코드 집중의 분석 및 설계
  - 접근 경로 설계, 뷰 설계
  - 정 안되면 반정규화 한다.

## 데이터베이스 기법

- 즉시 갱신 기법
  - 트랜잭션이 실행 상태에서 변경되는 내용을 그때변경
  - 변경되는 모든 내용은 로그에 기록
  - redo,undo모두 수행
- 회복기법
  - 지연갱신 기법
    - undo없이redo만 수행
  - 검사시점 기법
  - 그림자 페이징 기법

기본키로 묶은걸

## 테이블 용어

- 도메인
  - 하나의 어트리뷰트가 가질 수 있는 원자값들의 집합
  - 도메일이 릴레이션에 따라 다르다면 다 곱해준 값이 튜플이다.
- 튜플
  - 행이다.
- 엔티티는 테이블 자체
- 릴레이션은 한 테이블
- 스키마는 속성
- 튜플은 행
- 차수는 컬럼의 수 (속성의 수)
- 카디널리티는 튜플 (행)

## 릴레이션의 설명

- 릴레이션은 테이블이다.
- 릴레이션의 각 행을 튜플이라한다.
- 릴레이션의 각 열을 속성이라한다.
- 도메인은 속성의 값의 범위를 의미한다.
- 릴레이션의 차수는 속성의 수를 의미한다.
- 릴레이션의 카디널리티는 튜플의 수를 의미한다.

## 관계대수 연산

### 관계대수 연산 설명

- 절차적 방법
- 주어진 릴레이션 조작을 위한 연산의 집합
- 일반 집합과 순수 관계 연산으로 구분됨
- 질의에 대한 해를 구하기 위해 수행해야 할 연산의 순서를 명시
- 일반집합 연산자
- 순수관계 연산자
  - select : 시그마를 사용함 (아톰)
  - project : 파이
  - join : 나비넥타이
  - division : 나누기
- 집합관계 연산자 (일반집합)
  - 합집합 : U
  - 교집합 : 합집합 반대
  - 차집합 : -
  - 교차곱 : X

## 트랜젝션의 특징

- 원자성(Atomicity) : 모두 실행,모두 미실행 commit,rollback
- 일관성(Consistency) : 일관적으로 유지
- 격리성,독립성(Isolation) : 트랜젝션수행중 다른 트렌젝션에 영향을 주지 않아야한다.
- 영속성(Durablility): 영구히 보존된다.

## 분산 데이터베이스 투명성 조건

- 위치 (location)
- 분할 (division)
- 지역사상 (local mapping)
- 중복 (replication)
- 병행 (concurrency)
- 장애 (failure)

## 데이터 제어언어 (DCL) 기능

- 데이터 보안
- 무결성 유지
- 병행수행 제어

## 병행제어의 로킹단위는

- 디비안에 여러테이블이 있고 속성도 여러게고 튜플도 여러개이다.
- 여러 사람이 같은 데이터를 참조를할때 자물쇠로 잠궈버린다.
- 디비나 테이블이나 로우나 튜플에 걸 수 있음
- 로킹 단위가 크면 병행성이 낮아진다.
- 로킹 단위가 크면 오버헤드는 줄어든다.
- 로킹 단위가 작으면 병행성이 높아진다.
- 로킹 단위가 작으면 오버헤드는 늘어난다.

## 병행제어의 기법의 종류

- 로킹기법
- 2단계 로킹 규약
- 타임 스탬프 기법
- 낙관적 병행제어
- 다중 버전 기법

## 병행제어를 하지 않으면 일어나는 현상

- 갱신분실
- 비완료 의존성
- 모순성
- 연쇄복귀

## E-R모델의 표현방법

- 개체타입 : 사각형
- 관계타입 : 마름모
- 속성 : 동글뱅이
- 연결 : 선

## 키에 대한 설명

- 슈퍼키 : 유일성 o 최소성 x 나머지는 전부 만족해야함
- 후보키 : 유일성 최소성 만족해야함 나를 특정함 나머진 기본,대체키가된다.
- 기본키 : 유일성 최소성 만족해야함
- 외래키 : 참조하고 있는 키
- 대체키 : 기본키 외에 나머지

## 릴레이션 정규화 과정 (도부이결다조)

- 1nf : 도메인을 원자값으로 만든다.
- 2nf : 부분(완전)함수 종속을 제거해야함
- 3nf : 이행적 종속을 제거함 (x->y->z = x->z)
- BCNF: 결정자이면서 후보키가 아닌걸 제거
- 4nf : 다치 종속 제거
- 5nf : 조인을 제거나 이용한다.

## 정규화의 목적

- 릴레이션 데이터베이스 내에 표현 가능
- 데이터 삽입시 릴레이션재구성 필요없음
- 성능향상시 반 정규화를 한다.

## 정규화에서 E-R다이어그램 사용되는 기호

- 사각형 : 개체 타입
- 동그라미 : 속성
- 선 : 개체타입과 속성을 연결
- 마름모 : 관계 타입

## 반정규화

### 정의

- 데이터 베이스 정규화 후 성능향상 개발 편의성등을 위해 정규화 기법에 위배된 의도적 수행기법

### 종류

- 테이블 분할
  - 수평분할
  - 수직 분할
- 테이블 중복
  - 통계테이블 추가
  - 진행테이블 추가
- 컬럼 중복
  - 중복 칼럼추가
  - 파생 칼럼추가

## 데이터 모델

### 표시 요소

- 논리데이터 구조
- 연산
- 제약조건

## 관계형 데이터 모델

- relation 은 테이블
- attribute 속성
- tuple 로우
- cardinality 로우갯수

## 데이터웨어하우스의 기본적인 OLAP 연산은

### OLAP 정의

- 최종사용자가 직접 다차원으로 이루어진 데이터로부터 통계적인 요약정보를 분석하여 의사결정에 활용하는 방식

### OLAP 종류

- roll-up
- drill-down
- prvoting
- slicing
- dicing

## 시스템 카탈로그

- 데이터베이스를 관리하기위한 데이터
- 시스템 테이블 - 종류
- 데이터 사전이라고도 한다.
- DB가 관리해서 볼 수만있음
- 사용자가 접근은 가능하다.
- 수정,삽입,삭제 할 수 없음
- 메타데이터 라고도 한다.

## 병렬데이터베이스 환경중 수평분할에서 사용되는 분할기법

- 라운드 로빈
- 범위 분할
- 해시 분할
- 목록 분할
- 합성 분할
